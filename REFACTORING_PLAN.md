# –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ Bot.ts (1217 —Å—Ç—Ä–æ–∫ ‚Üí —á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- **Bot.ts –Ω–∞—á–∞–ª—å–Ω—ã–π**: 1217 —Å—Ç—Ä–æ–∫ (God Object anti-pattern)
- **Bot.ts –ø–æ—Å–ª–µ –≠–¢–ê–ü 1**: 1117 —Å—Ç—Ä–æ–∫ (-100 —Å—Ç—Ä–æ–∫)
- **Bot.ts –ø–æ—Å–ª–µ –≠–¢–ê–ü 2**: 950 —Å—Ç—Ä–æ–∫ (-167 —Å—Ç—Ä–æ–∫)
- **Bot.ts –ø–æ—Å–ª–µ –≠–¢–ê–ü 3**: 509 —Å—Ç—Ä–æ–∫ (-441 —Å—Ç—Ä–æ–∫–∞)
- **Bot.ts –ø–æ—Å–ª–µ –≠–¢–ê–ü 4**: 236 —Å—Ç—Ä–æ–∫ (-273 —Å—Ç—Ä–æ–∫–∏)
- **Bot.ts –ø–æ—Å–ª–µ –≠–¢–ê–ü 5**: 188 —Å—Ç—Ä–æ–∫ (-48 —Å—Ç—Ä–æ–∫)
- **–ò–¢–û–ì–û —É–¥–∞–ª–µ–Ω–æ**: 1029 —Å—Ç—Ä–æ–∫ (-85%)

## ‚úÖ –ß—Ç–æ —É–∂–µ —Ö–æ—Ä–æ—à–æ
- Service Layer (UserService, GroupService, GameService, SportService)
- Entities/Models —Å TypeORM
- Middleware –¥–ª—è –∞–≤—Ç–æ-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- Error handling

---

## ‚úÖ –≠–¢–ê–ü 1: UI Components (–ó–ê–í–ï–†–®–Å–ù)

**–¶–µ–ª—å**: –í—ã–Ω–µ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è UI-–∫–æ–¥ –≤ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
src/bot/ui/
  ‚îú‚îÄ‚îÄ KeyboardBuilder.ts     # –§–∞–±—Ä–∏–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä ‚úÖ
  ‚îú‚îÄ‚îÄ GameMessageBuilder.ts  # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –∏–≥—Ä–∞—Ö ‚úÖ
  ‚îî‚îÄ‚îÄ formatters.ts          # –£—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–∞—Ç—ã, —Å–ø–∏—Å–∫–∏) ‚úÖ
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã 3 —Ñ–∞–π–ª–∞ —Å UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- ‚úÖ Bot.ts —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 1217 ‚Üí 1117 —Å—Ç—Ä–æ–∫ (-100 —Å—Ç—Ä–æ–∫)
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, –∫–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## ‚úÖ –≠–¢–ê–ü 2: Command Pattern (–ó–ê–í–ï–†–®–Å–ù)

**–¶–µ–ª—å**: –†–∞–∑–¥–µ–ª–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–ª–∞—Å—Å—ã

### –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
src/bot/commands/
  ‚îú‚îÄ‚îÄ base/
  ‚îÇ   ‚îî‚îÄ‚îÄ CommandHandler.ts        # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å ‚úÖ
  ‚îú‚îÄ‚îÄ StartCommand.ts              # /start ‚úÖ
  ‚îú‚îÄ‚îÄ HelpCommand.ts               # /help ‚úÖ
  ‚îú‚îÄ‚îÄ RegisterCommand.ts           # /register ‚úÖ
  ‚îú‚îÄ‚îÄ NewGameCommand.ts            # /newgame ‚úÖ
  ‚îú‚îÄ‚îÄ GamesCommand.ts              # /games ‚úÖ
  ‚îú‚îÄ‚îÄ MyGroupsCommand.ts           # /mygroups ‚úÖ
  ‚îú‚îÄ‚îÄ CreateGroupCommand.ts        # /creategroup ‚úÖ
  ‚îî‚îÄ‚îÄ index.ts                     # –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ ‚úÖ
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- ‚úÖ –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å CommandHandler —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º CommandServices
- ‚úÖ 7 –∫–æ–º–∞–Ω–¥ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã
- ‚úÖ Dependency Injection —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
- ‚úÖ –ú–µ—Ç–æ–¥—ã isGroupOnly() –∏ isPrivateOnly() –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ Bot.ts –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—Å—Å–∏–≤ –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ initializeCommands()
- ‚úÖ registerCommands() —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã –≤ —Ü–∏–∫–ª–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –£–¥–∞–ª—ë–Ω –º–µ—Ç–æ–¥ setupCommands() (~200 —Å—Ç—Ä–æ–∫)
- ‚úÖ Bot.ts —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 1117 ‚Üí 950 —Å—Ç—Ä–æ–∫ (-167 —Å—Ç—Ä–æ–∫)
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- ‚úÖ –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ —Å –µ–¥–∏–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é

---

## ‚úÖ –≠–¢–ê–ü 3: Action Handlers (–ó–ê–í–ï–†–®–Å–ù)

**–¶–µ–ª—å**: –†–∞–∑–¥–µ–ª–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback_query

### –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
src/bot/handlers/
  ‚îú‚îÄ‚îÄ base/
  ‚îÇ   ‚îî‚îÄ‚îÄ ActionHandler.ts         # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å ‚úÖ
  ‚îú‚îÄ‚îÄ GameActionsHandler.ts        # join_confirmed, join_maybe, leave_game, show_participants, view_game ‚úÖ
  ‚îú‚îÄ‚îÄ GroupActionsHandler.ts       # group_, members_, leave_group_, remove_member_, manage_, manage_members_ ‚úÖ
  ‚îú‚îÄ‚îÄ GameCreationActionsHandler.ts # sport_, confirm_game_, cancel_game_ ‚úÖ
  ‚îî‚îÄ‚îÄ index.ts                     # –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö handlers ‚úÖ
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- ‚úÖ –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å ActionHandler —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º ActionServices
- ‚úÖ GameActionsHandler (165 —Å—Ç—Ä–æ–∫): –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É—á–∞—Å—Ç–∏—è –≤ –∏–≥—Ä–∞—Ö
  - handleJoinGame() - –∑–∞–ø–∏—Å—å –Ω–∞ –∏–≥—Ä—É (confirmed/maybe)
  - showParticipantsList() - —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
  - showGameDetails() - –¥–µ—Ç–∞–ª–∏ –∏–≥—Ä—ã
  - –î–µ–π—Å—Ç–≤–∏—è: join_confirmed, join_maybe, leave_game, show_participants, view_game
- ‚úÖ GroupActionsHandler (242 —Å—Ç—Ä–æ–∫–∏): —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏
  - –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º (group_, my_groups)
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (members_)
  - –í—ã—Ö–æ–¥ –∏–∑ –≥—Ä—É–ø–ø—ã (leave_group_)
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–æ–≤ (manage_, manage_members_, remove_member_)
- ‚úÖ GameCreationActionsHandler (103 —Å—Ç—Ä–æ–∫–∏): —Å–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä
  - –í—ã–±–æ—Ä –≤–∏–¥–∞ —Å–ø–æ—Ä—Ç–∞ (sport_)
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–º–µ–Ω–∞ (confirm_game_, cancel_game_)
- ‚úÖ Bot.ts –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∞—Å—Å–∏–≤ handlers —á–µ—Ä–µ–∑ initializeHandlers()
- ‚úÖ registerHandlers() —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç handlers –≤ —Ü–∏–∫–ª–µ

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –£–¥–∞–ª—ë–Ω –º–µ—Ç–æ–¥ setupActions() –∏ –≤—Å–µ action handlers (~470 —Å—Ç—Ä–æ–∫)
- ‚úÖ –í—ã–Ω–µ—Å–µ–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (handleJoinGame, showParticipantsList, showGameDetails)
- ‚úÖ Bot.ts —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 950 ‚Üí 509 —Å—Ç—Ä–æ–∫ (-441 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- ‚úÖ –ö–∞–∂–¥—ã–π handler –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ —Å –µ–¥–∏–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é

---

## ‚úÖ –≠–¢–ê–ü 4: Game Creation Flow (–ó–ê–í–ï–†–®–Å–ù)

**–¶–µ–ª—å**: –í—ã–Ω–µ—Å—Ç–∏ —Å–ª–æ–∂–Ω—É—é –ª–æ–≥–∏–∫—É —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã

### –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
src/bot/flows/
  ‚îú‚îÄ‚îÄ GameCreationFlow.ts          # –û—Å–Ω–æ–≤–Ω–æ–π flow (263 —Å—Ç—Ä–æ–∫–∏) ‚úÖ
  ‚îú‚îÄ‚îÄ GameCreationValidator.ts     # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ (131 —Å—Ç—Ä–æ–∫–∞) ‚úÖ
  ‚îî‚îÄ‚îÄ index.ts                     # –≠–∫—Å–ø–æ—Ä—Ç ‚úÖ
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- ‚úÖ GameCreationFlow –∫–ª–∞—Å—Å —Å –º–µ—Ç–æ–¥–æ–º handleTextInput()
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (—á–µ—Ä–µ–∑ /)
- ‚úÖ –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å GameCreationValidator
  - parseDate() - –ø–∞—Ä—Å–∏–Ω–≥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç—ã
  - validateLocation() - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞—Ü–∏–∏
  - validateMaxParticipants() / validateMinParticipants() - —É—á–∞—Å—Ç–Ω–∏–∫–∏
  - validateCost() - —Å—Ç–æ–∏–º–æ—Å—Ç—å
  - parseParticipantsRange() - –ø–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ä–º–∞—Ç–∞ "5-10" –∏–ª–∏ "10"
- ‚úÖ Bot.ts —Å–æ–∑–¥–∞—ë—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä GameCreationFlow –∏ –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–µ–∫—Å—Ç–∞
- ‚úÖ setupTextHandlers() —É–ø—Ä–æ—â—ë–Ω –¥–æ 8 —Å—Ç—Ä–æ–∫

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ 9 –º–µ—Ç–æ–¥–æ–≤ –∏–∑ Bot.ts (~273 —Å—Ç—Ä–æ–∫–∏)
  - handleQuickGameCreation
  - handleGameCreationStep
  - handleDateInput
  - handleLocationInput
  - handleMaxParticipantsInput
  - handleMinParticipantsInput
  - handleCostInput
  - handleNotesInput
  - showGameConfirmation
- ‚úÖ Bot.ts —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 509 ‚Üí 236 —Å—Ç—Ä–æ–∫ (-273 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- ‚úÖ –í—Å—è –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä–æ–≤–∞–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –º–æ–¥—É–ª–µ

---

## ‚úÖ –≠–¢–ê–ü 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ó–ê–í–ï–†–®–Å–ù)

**–¶–µ–ª—å**: Bot.ts –∫–∞–∫ —á–∏—Å—Ç—ã–π orchestrator (~150 —Å—Ç—Ä–æ–∫)

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- ‚úÖ –°–æ–∑–¥–∞–Ω GroupEventHandler (74 —Å—Ç—Ä–æ–∫–∏)
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ my_chat_member —Å–æ–±—ã—Ç–∏–π
  - handleBotAddedToGroup() - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≥—Ä—É–ø–ø—ã –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –±–æ—Ç–∞
  - handleBotRemovedFromGroup() - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
- ‚úÖ –£–ø—Ä–æ—â—ë–Ω setupMiddleware() - —É–¥–∞–ª—ë–Ω –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π my_chat_member –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã handleBotAddedToGroup –∏ handleBotRemovedFromGroup –∏–∑ Bot.ts
- ‚úÖ –û—á–∏—â–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã (Chat, ParticipationStatus, GroupRole, KeyboardBuilder, GameMessageBuilder)
- ‚úÖ Bot.ts —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ orchestrator

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ Bot.ts —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 236 ‚Üí 188 —Å—Ç—Ä–æ–∫ (-48 —Å—Ç—Ä–æ–∫, -20%)
- ‚úÖ –°–æ–∑–¥–∞–Ω GroupEventHandler (74 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
- ‚úÖ **Bot.ts —Ç–µ–ø–µ—Ä—å —á–∏—Å—Ç—ã–π orchestrator –±–µ–∑ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏!**

### –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Bot.ts (188 —Å—Ç—Ä–æ–∫):
1. **–ò–º–ø–æ—Ä—Ç—ã** (28 —Å—Ç—Ä–æ–∫)
2. **–ö–ª–∞—Å—Å –∏ —Å–≤–æ–π—Å—Ç–≤–∞** (11 —Å—Ç—Ä–æ–∫)
3. **–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä** (35 —Å—Ç—Ä–æ–∫)
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è services
   - –°–æ–∑–¥–∞–Ω–∏–µ flow –∏ handlers
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
4. **initializeCommands()** (20 —Å—Ç—Ä–æ–∫)
5. **registerCommands()** (5 —Å—Ç—Ä–æ–∫)
6. **initializeHandlers()** (15 —Å—Ç—Ä–æ–∫)
7. **registerHandlers()** (5 —Å—Ç—Ä–æ–∫)
8. **setupMiddleware()** (22 —Å—Ç—Ä–æ–∫–∏)
   - Auto-registration
   - Error handling
9. **setupTextHandlers()** (15 —Å—Ç—Ä–æ–∫)
10. **start()** (10 —Å—Ç—Ä–æ–∫)
11. **stop()** (4 —Å—Ç—Ä–æ–∫–∏)

---

## üéØ –≠–¢–ê–ü 5: Bot.ts –∫–∞–∫ —Ç–æ–Ω–∫–∏–π orchestrator

**–¶–µ–ª—å**: Bot.ts —Ç–æ–ª—å–∫–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã –∏ handlers

### –§–∏–Ω–∞–ª—å–Ω—ã–π Bot.ts (~150 —Å—Ç—Ä–æ–∫):
```typescript
export class Bot {
  private bot: Telegraf;
  private commands: CommandHandler[];
  private handlers: ActionHandler[];
  
  constructor() {
    this.bot = new Telegraf(token);
    this.setupMiddleware();
    this.registerCommands();
    this.registerHandlers();
  }
  
  private registerCommands() {
    this.commands.forEach(cmd => {
      this.bot.command(cmd.command, ctx => cmd.execute(ctx));
    });
  }
  
  private registerHandlers() {
    this.handlers.forEach(h => h.register(this.bot));
  }
}
```

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –î–û —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- Bot.ts: **1217 —Å—Ç—Ä–æ–∫** (God Object anti-pattern)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏—á–∏: –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ —Å–ª–æ–º–∞—Ç—å –≤—Å—ë
- –ö–æ–¥-—Ä–µ–≤—å—é: 1 –æ–≥—Ä–æ–º–Ω—ã–π –Ω–µ—á–∏—Ç–∞–µ–º—ã–π —Ñ–∞–π–ª
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞: –∫–æ—à–º–∞—Ä

### –ü–û–°–õ–ï —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- Bot.ts: **188 —Å—Ç—Ä–æ–∫** (-85%, pure orchestrator)
- **–°–æ–∑–¥–∞–Ω–æ 17 –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π** –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É Single Responsibility
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏—á–∏: –Ω–æ–≤—ã–π —Ñ–∞–π–ª, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –Ω–µ —Ç—Ä–æ–≥–∞–µ–º
- –ö–æ–¥-—Ä–µ–≤—å—é: –ø–æ–Ω—è—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞: –ª–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏–∑–º–µ–Ω–∏—Ç—å –Ω—É–∂–Ω—ã–π –∫–æ–¥
### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:

**UI Components (3 —Ñ–∞–π–ª–∞, –≠–¢–ê–ü 1):**
- `KeyboardBuilder.ts` - —Ñ–∞–±—Ä–∏–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- `GameMessageBuilder.ts` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- `formatters.ts` - —É—Ç–∏–ª–∏—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**Commands (8 —Ñ–∞–π–ª–æ–≤, –≠–¢–ê–ü 2):**
- `base/CommandHandler.ts` - –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
- `StartCommand.ts`, `HelpCommand.ts`, `RegisterCommand.ts`
- `NewGameCommand.ts`, `GamesCommand.ts`, `MyGroupsCommand.ts`, `CreateGroupCommand.ts`

**Handlers (5 —Ñ–∞–π–ª–æ–≤, –≠–¢–ê–ü 3 + –≠–¢–ê–ü 5):**
- `base/ActionHandler.ts` - –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
- `GameActionsHandler.ts` - —É—á–∞—Å—Ç–∏–µ –≤ –∏–≥—Ä–∞—Ö
- `GroupActionsHandler.ts` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∞–º–∏
- `GameCreationActionsHandler.ts` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è
- `GroupEventHandler.ts` - —Å–æ–±—ã—Ç–∏—è –≥—Ä—É–ø–ø (add/remove bot)

**Flows (3 —Ñ–∞–π–ª–∞, –≠–¢–ê–ü 4):**
- `GameCreationFlow.ts` - –æ—Å–Ω–æ–≤–Ω–æ–π flow —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä
- `GameCreationValidator.ts` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- `index.ts` - barrel export

### –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
```
src/
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ Bot.ts                     # 188 —Å—Ç—Ä–æ–∫ - pure orchestrator ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ commands/                  # 7 –∫–æ–º–∞–Ω–¥ + base class
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base/CommandHandler.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StartCommand.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HelpCommand.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterCommand.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NewGameCommand.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GamesCommand.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MyGroupsCommand.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CreateGroupCommand.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ handlers/                  # 4 action handlers + base class
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base/ActionHandler.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameActionsHandler.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GroupActionsHandler.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameCreationActionsHandler.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GroupEventHandler.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ flows/                     # Game creation flow
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameCreationFlow.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GameCreationValidator.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îî‚îÄ‚îÄ ui/                        # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ KeyboardBuilder.ts
‚îÇ       ‚îú‚îÄ‚îÄ GameMessageBuilder.ts
‚îÇ       ‚îî‚îÄ‚îÄ formatters.ts
‚îú‚îÄ‚îÄ services/                      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—É–∂–µ –±—ã–ª–æ)
‚îú‚îÄ‚îÄ models/                        # Entities (—É–∂–µ –±—ã–ª–æ)
‚îî‚îÄ‚îÄ utils/                         # –£—Ç–∏–ª–∏—Ç—ã (—É–∂–µ –±—ã–ª–æ)
‚îú‚îÄ‚îÄ models/                        # –£–∂–µ —Ö–æ—Ä–æ—à–æ
‚îî‚îÄ‚îÄ utils/                         # –£–∂–µ —Ö–æ—Ä–æ—à–æ
```

---

## üöÄ –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. ‚úÖ **–≠–¢–ê–ü 1**: UI Components (–±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–µ –ª–æ–º–∞–µ—Ç –ª–æ–≥–∏–∫—É)
2. ‚úÖ **–≠–¢–ê–ü 2**: Commands (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã)
3. ‚úÖ **–≠–¢–ê–ü 3**: Action Handlers (callback logic)
4. ‚úÖ **–≠–¢–ê–ü 4**: Game Creation Flow (—Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞)
5. ‚úÖ **–≠–¢–ê–ü 5**: –§–∏–Ω–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Bot.ts

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- ‚úÖ –ö–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É

---

## üéì –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

- **Command Pattern** - –∫–æ–º–∞–Ω–¥—ã –∫–∞–∫ –æ–±—ä–µ–∫—Ç—ã
- **Strategy Pattern** - —Ä–∞–∑–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ actions
- **Builder Pattern** - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- **State Pattern** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã
- **Facade Pattern** - Bot.ts –∫–∞–∫ —Ñ–∞—Å–∞–¥
- **Dependency Injection** - —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

## üìù –ü—Ä–∏–Ω—Ü–∏–ø—ã

- **SOLID**: Single Responsibility –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
- **DRY**: –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **KISS**: –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –ø–æ–Ω—è—Ç–Ω–æ—Å—Ç—å –∫–æ–¥–∞
- **YAGNI**: –ù–µ —É—Å–ª–æ–∂–Ω—è–µ–º —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
